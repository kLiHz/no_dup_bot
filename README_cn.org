#+TITLE: 火星 Bot
一个 Telegram Bot，在群里反复收到群友转发同一个频道消息时提醒他火星了，并且把之前转发消息的链接拍在他脸上。 [[README.org][English Readme]]

* 设计
本 Bot 设计对下述转发做出反应：
- 整条消息都是一个 URL
- 消息转发自一个 *公开频道*


本 Bot 不对下述转发做出反应：
- 消息转发自其他群
- 消息转发自 *本群* 。避免群友“转发复读机”
- 消息转发自 *私有频道*

  当一条消息被转发到当前群组时，我们获取一个指向原频道中该消息的链接。之前看到的链接作为 key 存在一个 KV store 里，其值包括看到的次数。如果新消息的链接在 KV store 中可以找到，那么说明我们见过这条消息，应该增加计数，并且把之前转发消息的链接拍在他脸上。如果没看见，就默默记下来，次数为 1。URL 链接的处理与之类似。

* 计划
- 支持对重复出现的图片做出反应。有人说 Telegram 里存储的图片是有唯一 ID 的，大概可以用
- 使用 ~/delete~ 回复 Bot 的一条消息时，删除被回复的消息。目前实现存在一些技术障碍
